generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  userId        Int                 @id @default(autoincrement()) @map("user_id")
  email         String              @unique
  username      String?
  password      String?
  googleId      String?             @unique @map("google_id")
  points        Int                 @default(0)
  level         Int                 @default(1)
  pokemonPetId  Int?                @map("pokemon_pet_id")
  createdAt     DateTime            @default(now()) @map("created_at")
  dailyQuests   DailyQuest[]
  gamification  Gamification?
  taskHistory   TaskHistory[]
  tasks         Task[]
  caughtPokemon UserCaughtPokemon[]
  pokemonPet    PokemonPet?         @relation(fields: [pokemonPetId], references: [petId])

  @@map("users")
}

model PokemonPet {
  petId            Int    @id @default(autoincrement()) @map("pet_id")
  name             String @unique
  spriteStage1     String @map("sprite_stage_1")
  spriteStage2     String @map("sprite_stage_2")
  spriteStage3     String @map("sprite_stage_3")
  description      String
  evolution_levels Json
  type             String
  users            User[]

  @@map("pokemon_pets")
}

model Task {
  taskId      Int           @id @default(autoincrement()) @map("task_id")
  userId      Int           @map("user_id")
  title       String
  description String?
  category    String?
  priority    String?       @default("Medium")
  isDone      Boolean       @default(false) @map("is_done")
  createdAt   DateTime      @default(now()) @map("created_at")
  updatedAt   DateTime      @updatedAt @map("updated_at")
  user        User          @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@map("tasks")
}

model TaskHistory {
  historyId   Int       @id @default(autoincrement()) @map("history_id")
  userId      Int       @map("user_id")
  taskId      Int       @map("task_id")
  title       String
  description String?
  category    String?
  priority    String?
  date        DateTime  @db.Date
  isDone      Boolean   @map("is_done")
  completedAt DateTime? @map("completed_at")
  user        User      @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@map("task_history")
}

model Gamification {
  gamificationId Int      @id @default(autoincrement()) @map("gamification_id")
  userId         Int      @unique @map("user_id")
  points         Int      @default(0)
  streakCount    Int      @default(0) @map("streak_count")
  badges         String[] @default([])
  level          Int      @default(1)
  lastUpdated    DateTime @default(now()) @map("last_updated")
  user           User     @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@map("gamification")
}

model DailyQuest {
  questId     Int      @id @default(autoincrement()) @map("quest_id")
  userId      Int      @map("user_id")
  title       String
  points      Int      @default(0)
  isCompleted Boolean  @default(false) @map("is_completed")
  createdAt   DateTime @default(now()) @map("created_at")
  user        User     @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@map("daily_quests")
}

model UserCaughtPokemon {
  id                   Int               @id @default(autoincrement())
  userId               Int               @map("user_id")
  caughtAt             DateTime          @default(now()) @map("caught_at")
  isCompanion          Boolean           @default(false) @map("is_companion")
  catchable_pokemon_id Int
  catchable_pokemon    catchable_pokemon @relation(fields: [catchable_pokemon_id], references: [id], onDelete: Cascade)
  user                 User              @relation(fields: [userId], references: [userId], onDelete: Cascade)

  @@unique([userId, catchable_pokemon_id])
  @@map("user_caught_pokemon")
}

model catchable_pokemon {
  id                  Int                 @id @default(autoincrement())
  pokemon_id          Int                 @unique
  name                String              @unique
  sprite              String
  type                String
  rarity              String
  difficulty          Int
  description         String
  catch_requirement   String
  points_reward       Int
  user_caught_pokemon UserCaughtPokemon[]
}

model PokemonGif {
  id        Int      @id @default(autoincrement())
  pokemonId Int      @unique @map("pokemon_id")
  name      String
  gifData   String   @map("gif_data") // Base64 encoded GIF data
  createdAt DateTime @default(now()) @map("created_at")

  @@map("pokemon_gifs")
}
